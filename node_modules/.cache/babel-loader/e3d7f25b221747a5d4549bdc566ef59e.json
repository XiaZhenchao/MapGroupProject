{"ast":null,"code":"var file = require(\"./file\"),\n  iconv = require(\"iconv-lite\");\nexports.read = require(\"./read\")(reader);\nexports.reader = reader;\nfunction reader(filename, encoding) {\n  var fileReader = file.reader(filename),\n    decode = utf8.test(encoding) ? decodeUtf8 : decoder(encoding || \"ISO-8859-1\"),\n    fieldDescriptors = [],\n    recordBytes;\n  function readHeader(callback) {\n    fileReader.read(32, function (error, fileHeader) {\n      if (fileHeader === end) error = new Error(\"unexpected EOF\");\n      if (error) return void callback(error);\n      var fileType = fileHeader.readUInt8(0),\n        // TODO verify 3\n        fileDate = new Date(1900 + fileHeader.readUInt8(1), fileHeader.readUInt8(2) - 1, fileHeader.readUInt8(3)),\n        recordCount = fileHeader.readUInt32LE(4);\n      recordBytes = fileHeader.readUInt16LE(10);\n      fileReader.read(fileHeader.readUInt16LE(8) - 32, function readFields(error, fields) {\n        var n = 0;\n        while (fields.readUInt8(n) != 0x0d) {\n          fieldDescriptors.push({\n            name: fieldName(decode(fields, n, n + 11)),\n            type: fields.toString(\"ascii\", n + 11, n + 12),\n            length: fields.readUInt8(n + 16)\n          });\n          n += 32;\n        }\n        callback(null, {\n          version: fileType,\n          date: fileDate,\n          count: recordCount,\n          fields: fieldDescriptors\n        });\n      });\n    });\n    return this;\n  }\n  function readRecord(callback) {\n    if (!recordBytes) return callback(new Error(\"must read header before reading records\")), this;\n    fileReader.read(recordBytes, function readRecord(error, record) {\n      if (record === end) return callback(null, end);\n      if (error) return void callback(error);\n      var i = 1;\n      callback(null, fieldDescriptors.map(function (field) {\n        return fieldTypes[field.type](decode(record, i, i += field.length));\n      }));\n    });\n    return this;\n  }\n  function close(callback) {\n    fileReader.close(callback);\n    return this;\n  }\n  return {\n    readHeader: readHeader,\n    readRecord: readRecord,\n    close: close\n  };\n}\nvar end = exports.end = file.end;\nvar utf8 = /^utf[-]?8$/i;\nfunction decoder(encoding) {\n  return function (buffer, i, j) {\n    return iconv.decode(buffer.slice(i, j), encoding);\n  };\n}\nfunction decodeUtf8(buffer, i, j) {\n  return buffer.toString(\"utf8\", i, j);\n}\nvar fieldTypes = {\n  B: fieldNumber,\n  C: fieldString,\n  D: fieldDate,\n  F: fieldNumber,\n  L: fieldBoolean,\n  M: fieldNumber,\n  N: fieldNumber\n};\nfunction fieldNumber(d) {\n  return isNaN(d = +d) ? null : d;\n}\nfunction fieldString(d) {\n  return d.trim() || null;\n}\nfunction fieldDate(d) {\n  return new Date(+d.substring(0, 4), d.substring(4, 6) - 1, +d.substring(6, 8));\n}\nfunction fieldBoolean(d) {\n  return /^[nf]$/i.test(d) ? false : /^[yt]$/i.test(d) ? true : null;\n}\nfunction fieldName(string) {\n  var i = string.indexOf(\"\\0\");\n  return i < 0 ? string : string.substring(0, i);\n}","map":{"version":3,"names":["file","require","iconv","exports","read","reader","filename","encoding","fileReader","decode","utf8","test","decodeUtf8","decoder","fieldDescriptors","recordBytes","readHeader","callback","error","fileHeader","end","Error","fileType","readUInt8","fileDate","Date","recordCount","readUInt32LE","readUInt16LE","readFields","fields","n","push","name","fieldName","type","toString","length","version","date","count","readRecord","record","i","map","field","fieldTypes","close","buffer","j","slice","B","fieldNumber","C","fieldString","D","fieldDate","F","L","fieldBoolean","M","N","d","isNaN","trim","substring","string","indexOf"],"sources":["/Users/yongerfan/Desktop/GroupProject/MapGroupProject/node_modules/shapefile/dbf.js"],"sourcesContent":["var file = require(\"./file\"),\n    iconv = require(\"iconv-lite\");\n\nexports.read = require(\"./read\")(reader);\nexports.reader = reader;\n\nfunction reader(filename, encoding) {\n  var fileReader = file.reader(filename),\n      decode = utf8.test(encoding) ? decodeUtf8 : decoder(encoding || \"ISO-8859-1\"),\n      fieldDescriptors = [],\n      recordBytes;\n\n  function readHeader(callback) {\n    fileReader.read(32, function(error, fileHeader) {\n      if (fileHeader === end) error = new Error(\"unexpected EOF\");\n      if (error) return void callback(error);\n      var fileType = fileHeader.readUInt8(0), // TODO verify 3\n          fileDate = new Date(1900 + fileHeader.readUInt8(1), fileHeader.readUInt8(2) - 1, fileHeader.readUInt8(3)),\n          recordCount = fileHeader.readUInt32LE(4);\n      recordBytes = fileHeader.readUInt16LE(10);\n      fileReader.read(fileHeader.readUInt16LE(8) - 32, function readFields(error, fields) {\n        var n = 0;\n        while (fields.readUInt8(n) != 0x0d) {\n          fieldDescriptors.push({\n            name: fieldName(decode(fields, n, n + 11)),\n            type: fields.toString(\"ascii\", n + 11, n + 12),\n            length: fields.readUInt8(n + 16)\n          });\n          n += 32;\n        }\n        callback(null, {\n          version: fileType,\n          date: fileDate,\n          count: recordCount,\n          fields: fieldDescriptors\n        });\n      });\n    });\n    return this;\n  }\n\n  function readRecord(callback) {\n    if (!recordBytes) return callback(new Error(\"must read header before reading records\")), this;\n    fileReader.read(recordBytes, function readRecord(error, record) {\n      if (record === end) return callback(null, end);\n      if (error) return void callback(error);\n      var i = 1;\n      callback(null, fieldDescriptors.map(function(field) {\n        return fieldTypes[field.type](decode(record, i, i += field.length));\n      }));\n    });\n    return this;\n  }\n\n  function close(callback) {\n    fileReader.close(callback);\n    return this;\n  }\n\n  return {\n    readHeader: readHeader,\n    readRecord: readRecord,\n    close: close\n  };\n}\n\nvar end = exports.end = file.end;\n\nvar utf8 = /^utf[-]?8$/i;\n\nfunction decoder(encoding) {\n  return function(buffer, i, j) {\n    return iconv.decode(buffer.slice(i, j), encoding);\n  };\n}\n\nfunction decodeUtf8(buffer, i, j) {\n  return buffer.toString(\"utf8\", i, j);\n}\n\nvar fieldTypes = {\n  B: fieldNumber,\n  C: fieldString,\n  D: fieldDate,\n  F: fieldNumber,\n  L: fieldBoolean,\n  M: fieldNumber,\n  N: fieldNumber\n};\n\nfunction fieldNumber(d) {\n  return isNaN(d = +d) ? null : d;\n}\n\nfunction fieldString(d) {\n  return d.trim() || null;\n}\n\nfunction fieldDate(d) {\n  return new Date(+d.substring(0, 4), d.substring(4, 6) - 1, +d.substring(6, 8));\n}\n\nfunction fieldBoolean(d) {\n  return /^[nf]$/i.test(d) ? false\n      : /^[yt]$/i.test(d) ? true\n      : null;\n}\n\nfunction fieldName(string) {\n  var i = string.indexOf(\"\\0\");\n  return i < 0 ? string : string.substring(0, i);\n}\n"],"mappings":"AAAA,IAAIA,IAAI,GAAGC,OAAO,CAAC,QAAQ,CAAC;EACxBC,KAAK,GAAGD,OAAO,CAAC,YAAY,CAAC;AAEjCE,OAAO,CAACC,IAAI,GAAGH,OAAO,CAAC,QAAQ,CAAC,CAACI,MAAM,CAAC;AACxCF,OAAO,CAACE,MAAM,GAAGA,MAAM;AAEvB,SAASA,MAAMA,CAACC,QAAQ,EAAEC,QAAQ,EAAE;EAClC,IAAIC,UAAU,GAAGR,IAAI,CAACK,MAAM,CAACC,QAAQ,CAAC;IAClCG,MAAM,GAAGC,IAAI,CAACC,IAAI,CAACJ,QAAQ,CAAC,GAAGK,UAAU,GAAGC,OAAO,CAACN,QAAQ,IAAI,YAAY,CAAC;IAC7EO,gBAAgB,GAAG,EAAE;IACrBC,WAAW;EAEf,SAASC,UAAUA,CAACC,QAAQ,EAAE;IAC5BT,UAAU,CAACJ,IAAI,CAAC,EAAE,EAAE,UAASc,KAAK,EAAEC,UAAU,EAAE;MAC9C,IAAIA,UAAU,KAAKC,GAAG,EAAEF,KAAK,GAAG,IAAIG,KAAK,CAAC,gBAAgB,CAAC;MAC3D,IAAIH,KAAK,EAAE,OAAO,KAAKD,QAAQ,CAACC,KAAK,CAAC;MACtC,IAAII,QAAQ,GAAGH,UAAU,CAACI,SAAS,CAAC,CAAC,CAAC;QAAE;QACpCC,QAAQ,GAAG,IAAIC,IAAI,CAAC,IAAI,GAAGN,UAAU,CAACI,SAAS,CAAC,CAAC,CAAC,EAAEJ,UAAU,CAACI,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEJ,UAAU,CAACI,SAAS,CAAC,CAAC,CAAC,CAAC;QACzGG,WAAW,GAAGP,UAAU,CAACQ,YAAY,CAAC,CAAC,CAAC;MAC5CZ,WAAW,GAAGI,UAAU,CAACS,YAAY,CAAC,EAAE,CAAC;MACzCpB,UAAU,CAACJ,IAAI,CAACe,UAAU,CAACS,YAAY,CAAC,CAAC,CAAC,GAAG,EAAE,EAAE,SAASC,UAAUA,CAACX,KAAK,EAAEY,MAAM,EAAE;QAClF,IAAIC,CAAC,GAAG,CAAC;QACT,OAAOD,MAAM,CAACP,SAAS,CAACQ,CAAC,CAAC,IAAI,IAAI,EAAE;UAClCjB,gBAAgB,CAACkB,IAAI,CAAC;YACpBC,IAAI,EAAEC,SAAS,CAACzB,MAAM,CAACqB,MAAM,EAAEC,CAAC,EAAEA,CAAC,GAAG,EAAE,CAAC,CAAC;YAC1CI,IAAI,EAAEL,MAAM,CAACM,QAAQ,CAAC,OAAO,EAAEL,CAAC,GAAG,EAAE,EAAEA,CAAC,GAAG,EAAE,CAAC;YAC9CM,MAAM,EAAEP,MAAM,CAACP,SAAS,CAACQ,CAAC,GAAG,EAAE;UACjC,CAAC,CAAC;UACFA,CAAC,IAAI,EAAE;QACT;QACAd,QAAQ,CAAC,IAAI,EAAE;UACbqB,OAAO,EAAEhB,QAAQ;UACjBiB,IAAI,EAAEf,QAAQ;UACdgB,KAAK,EAAEd,WAAW;UAClBI,MAAM,EAAEhB;QACV,CAAC,CAAC;MACJ,CAAC,CAAC;IACJ,CAAC,CAAC;IACF,OAAO,IAAI;EACb;EAEA,SAAS2B,UAAUA,CAACxB,QAAQ,EAAE;IAC5B,IAAI,CAACF,WAAW,EAAE,OAAOE,QAAQ,CAAC,IAAII,KAAK,CAAC,yCAAyC,CAAC,CAAC,EAAE,IAAI;IAC7Fb,UAAU,CAACJ,IAAI,CAACW,WAAW,EAAE,SAAS0B,UAAUA,CAACvB,KAAK,EAAEwB,MAAM,EAAE;MAC9D,IAAIA,MAAM,KAAKtB,GAAG,EAAE,OAAOH,QAAQ,CAAC,IAAI,EAAEG,GAAG,CAAC;MAC9C,IAAIF,KAAK,EAAE,OAAO,KAAKD,QAAQ,CAACC,KAAK,CAAC;MACtC,IAAIyB,CAAC,GAAG,CAAC;MACT1B,QAAQ,CAAC,IAAI,EAAEH,gBAAgB,CAAC8B,GAAG,CAAC,UAASC,KAAK,EAAE;QAClD,OAAOC,UAAU,CAACD,KAAK,CAACV,IAAI,CAAC,CAAC1B,MAAM,CAACiC,MAAM,EAAEC,CAAC,EAAEA,CAAC,IAAIE,KAAK,CAACR,MAAM,CAAC,CAAC;MACrE,CAAC,CAAC,CAAC;IACL,CAAC,CAAC;IACF,OAAO,IAAI;EACb;EAEA,SAASU,KAAKA,CAAC9B,QAAQ,EAAE;IACvBT,UAAU,CAACuC,KAAK,CAAC9B,QAAQ,CAAC;IAC1B,OAAO,IAAI;EACb;EAEA,OAAO;IACLD,UAAU,EAAEA,UAAU;IACtByB,UAAU,EAAEA,UAAU;IACtBM,KAAK,EAAEA;EACT,CAAC;AACH;AAEA,IAAI3B,GAAG,GAAGjB,OAAO,CAACiB,GAAG,GAAGpB,IAAI,CAACoB,GAAG;AAEhC,IAAIV,IAAI,GAAG,aAAa;AAExB,SAASG,OAAOA,CAACN,QAAQ,EAAE;EACzB,OAAO,UAASyC,MAAM,EAAEL,CAAC,EAAEM,CAAC,EAAE;IAC5B,OAAO/C,KAAK,CAACO,MAAM,CAACuC,MAAM,CAACE,KAAK,CAACP,CAAC,EAAEM,CAAC,CAAC,EAAE1C,QAAQ,CAAC;EACnD,CAAC;AACH;AAEA,SAASK,UAAUA,CAACoC,MAAM,EAAEL,CAAC,EAAEM,CAAC,EAAE;EAChC,OAAOD,MAAM,CAACZ,QAAQ,CAAC,MAAM,EAAEO,CAAC,EAAEM,CAAC,CAAC;AACtC;AAEA,IAAIH,UAAU,GAAG;EACfK,CAAC,EAAEC,WAAW;EACdC,CAAC,EAAEC,WAAW;EACdC,CAAC,EAAEC,SAAS;EACZC,CAAC,EAAEL,WAAW;EACdM,CAAC,EAAEC,YAAY;EACfC,CAAC,EAAER,WAAW;EACdS,CAAC,EAAET;AACL,CAAC;AAED,SAASA,WAAWA,CAACU,CAAC,EAAE;EACtB,OAAOC,KAAK,CAACD,CAAC,GAAG,CAACA,CAAC,CAAC,GAAG,IAAI,GAAGA,CAAC;AACjC;AAEA,SAASR,WAAWA,CAACQ,CAAC,EAAE;EACtB,OAAOA,CAAC,CAACE,IAAI,CAAC,CAAC,IAAI,IAAI;AACzB;AAEA,SAASR,SAASA,CAACM,CAAC,EAAE;EACpB,OAAO,IAAIrC,IAAI,CAAC,CAACqC,CAAC,CAACG,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,EAAEH,CAAC,CAACG,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,EAAE,CAACH,CAAC,CAACG,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AAChF;AAEA,SAASN,YAAYA,CAACG,CAAC,EAAE;EACvB,OAAO,SAAS,CAACnD,IAAI,CAACmD,CAAC,CAAC,GAAG,KAAK,GAC1B,SAAS,CAACnD,IAAI,CAACmD,CAAC,CAAC,GAAG,IAAI,GACxB,IAAI;AACZ;AAEA,SAAS5B,SAASA,CAACgC,MAAM,EAAE;EACzB,IAAIvB,CAAC,GAAGuB,MAAM,CAACC,OAAO,CAAC,IAAI,CAAC;EAC5B,OAAOxB,CAAC,GAAG,CAAC,GAAGuB,MAAM,GAAGA,MAAM,CAACD,SAAS,CAAC,CAAC,EAAEtB,CAAC,CAAC;AAChD"},"metadata":{},"sourceType":"script"}